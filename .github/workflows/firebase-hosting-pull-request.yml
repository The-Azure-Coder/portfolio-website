# .github/workflows/firebase-hosting-pr.yml
name: Deploy to Firebase Hosting on PR

on:
  pull_request:

# Explicit permissions to allow creating checks in the same repo
permissions:
  contents: read
  checks: write

jobs:
  build_and_preview:
    # Only run for PRs from the same repository (skip forked PRs)
    if: ${{ github.event.pull_request.head.repo.full_name == github.repository }}
    runs-on: ubuntu-latest

    steps:
      # Checkout the repository
      - uses: actions/checkout@v3

      # (Optional) Build your project here if needed
      # - run: npm ci && npm run build

      # Deploy to Firebase Hosting preview
      - uses: FirebaseExtended/action-hosting-deploy@v0
        with:
          repoToken: ${{ secrets.GITHUB_TOKEN }}
          firebaseServiceAccount: ${{ secrets.FIREBASE_SERVICE_ACCOUNT_MORGAN_PORTFOLIO }}
          projectId: morgan-portfolio
          entryPoint: .
          firebaseToolsVersion: latest
          disableComment: false    # Set true if you don't want GitHub check comments
          force: false
          expires: 7d
